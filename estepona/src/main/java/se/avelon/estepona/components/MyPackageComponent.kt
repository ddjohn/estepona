/*
 * Copyright 2025 David Johansson
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package se.avelon.estepona.components

import android.content.Intent
import android.content.pm.PackageInfo
import android.content.pm.PackageManager.GET_PERMISSIONS
import android.content.pm.PackageManager.GET_SIGNATURES
import android.content.pm.PackageManager.MATCH_ALL
import android.content.pm.PermissionInfo.PROTECTION_DANGEROUS
import android.content.pm.PermissionInfo.PROTECTION_FLAG_PRIVILEGED
import android.content.pm.Signature
import androidx.compose.foundation.BorderStroke
import androidx.compose.foundation.Image
import androidx.compose.foundation.layout.Arrangement
import androidx.compose.foundation.layout.Column
import androidx.compose.foundation.layout.ExperimentalLayoutApi
import androidx.compose.foundation.layout.FlowRow
import androidx.compose.foundation.layout.fillMaxSize
import androidx.compose.foundation.layout.padding
import androidx.compose.foundation.layout.size
import androidx.compose.foundation.lazy.LazyColumn
import androidx.compose.material3.Card
import androidx.compose.material3.MaterialTheme
import androidx.compose.material3.Text
import androidx.compose.runtime.Composable
import androidx.compose.ui.Modifier
import androidx.compose.ui.graphics.Color
import androidx.compose.ui.graphics.asImageBitmap
import androidx.compose.ui.platform.LocalContext
import androidx.compose.ui.unit.dp
import androidx.core.graphics.drawable.toBitmap
import java.util.StringTokenizer
import se.avelon.estepona.components.packages.PackageItemData
import se.avelon.estepona.logging.DLog

class MyPackageComponent {
  companion object {
    val TAG = DLog.forTag(MyPackageComponent::class.java)
  }
}

@Composable
fun PackageButton(modifier: Modifier = Modifier, item: PackageItemData, onClick: () -> Unit) {
  DLog.method(MyPackageComponent.TAG, "PackageButton()")

  Card(
    modifier = Modifier.size(64.dp, 64.dp).padding(8.dp),
    onClick = onClick,
    border = BorderStroke(2.dp, Color.Red),
  ) {
    Column {
      Image(bitmap = item.icon?.toBitmap()?.asImageBitmap()!!, contentDescription = "description")
      Text(text = item.text)
    }
  }
}

@OptIn(ExperimentalLayoutApi::class)
@Composable
fun PackageGrid(modifier: Modifier = Modifier) {
  DLog.method(MyPackageComponent.TAG, "PackageGrid()")
  LazyColumn(
    modifier = modifier.fillMaxSize().padding(16.dp),
    verticalArrangement = Arrangement.Center,
  ) {
    DLog.method(MyPackageComponent.TAG, "LazyColumn()")

    item {
      Text(
        modifier = Modifier.padding(bottom = 16.dp),
        text = "Packages",
        style = MaterialTheme.typography.titleMedium,
      )
    }

    item {
      FlowRow(horizontalArrangement = Arrangement.spacedBy(16.dp)) {
        DLog.method(MyPackageComponent.TAG, "FlowRow()")

        val context = LocalContext.current
        val packageManager = context.packageManager
        for (pkg in packageManager.getInstalledPackages(MATCH_ALL)) {
          val item =
            PackageItemData(
              pkg.packageName,
              pkg.applicationInfo?.loadIcon(context?.packageManager),
              packageManager?.getApplicationLabel(pkg.applicationInfo!!).toString(),
            )

          if (context.packageManager?.getLaunchIntentForPackage(pkg.packageName) != null) {
            PackageButton(
              item = item,
              onClick = {
                DLog.method(MyPackageComponent.TAG, "onClick(): $this")

                val intent = Intent(Intent.ACTION_MAIN)
                intent.addCategory(Intent.CATEGORY_LAUNCHER)
                intent.setFlags(
                  Intent.FLAG_ACTIVITY_NEW_TASK or Intent.FLAG_ACTIVITY_RESET_TASK_IF_NEEDED
                )
                intent.setPackage(item.pkg)
                context.startActivity(context.packageManager?.getLaunchIntentForPackage(item.pkg))
              },
            )
          }
        }
      }
    }
  }

  val packageManager = LocalContext.current.packageManager

  DLog.info(MyPackageComponent.TAG, "Scanning...")
  for (pkgInfo in
    packageManager.getInstalledPackages(MATCH_ALL or GET_PERMISSIONS or GET_SIGNATURES)) {
    DLog.info(MyPackageComponent.TAG, "Scanning: ${pkgInfo.packageName}")

    val myPackageName = pkgInfo.packageName
    val mySignature = getSignatures(pkgInfo)
    val path = StringTokenizer(pkgInfo.applicationInfo?.publicSourceDir, "/")

    val partition = path.nextElement()
    val privApp = path.nextElement()
    val sys = if (pkgInfo.applicationInfo?.uid == 1001000) "===SYSTEM===" else ""

    DLog.info(MyPackageComponent.TAG, "=== $myPackageName:$partition:$privApp:$mySignature:$sys: ")

    if (pkgInfo.permissions != null) {
      for (permission in pkgInfo.permissions) {
        if (permission.name.contains("DYNAMIC_RECEIVER_NOT_EXPORTED_PERMISSION")) {
          continue
        }

        if (
          permission.protectionFlags.and(PROTECTION_FLAG_PRIVILEGED.or(PROTECTION_DANGEROUS)) == 0
        ) {
          DLog.error(
            MyPackageComponent.TAG,
            "--- Permission: No,  ${permission.name}, flags=${permission.protectionFlags}",
          )
        } else {
          DLog.info(
            MyPackageComponent.TAG,
            "--- Permission: Yes, ${permission.name}, flags=${permission.protectionFlags}",
          )
        }
      }
    }
  }
}

private fun getSignatures(pkgInfo: PackageInfo): String {
  var str = ""
  if (pkgInfo.signatures != null) {
    for (signature in pkgInfo.signatures) {
      str = str + " " + getSignature(signature)
    }
  }
  return str
}

fun getSignature(signature: Signature): String {
  val sign = signature.toCharsString()

  return if (
    sign.compareTo(
      "308204a830820390a003020102020900b3998086d056cffa300d06092a864886f70d0101040500308194310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630140603550407130d4d6f756e7461696e20566965773110300e060355040a1307416e64726f69643110300e060355040b1307416e64726f69643110300e06035504031307416e64726f69643122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d301e170d3038303431353232343035305a170d3335303930313232343035305a308194310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630140603550407130d4d6f756e7461696e20566965773110300e060355040a1307416e64726f69643110300e060355040b1307416e64726f69643110300e06035504031307416e64726f69643122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d30820120300d06092a864886f70d01010105000382010d003082010802820101009c780592ac0d5d381cdeaa65ecc8a6006e36480c6d7207b12011be50863aabe2b55d009adf7146d6f2202280c7cd4d7bdb26243b8a806c26b34b137523a49268224904dc01493e7c0acf1a05c874f69b037b60309d9074d24280e16bad2a8734361951eaf72a482d09b204b1875e12ac98c1aa773d6800b9eafde56d58bed8e8da16f9a360099c37a834a6dfedb7b6b44a049e07a269fccf2c5496f2cf36d64df90a3b8d8f34a3baab4cf53371ab27719b3ba58754ad0c53fc14e1db45d51e234fbbe93c9ba4edf9ce54261350ec535607bf69a2ff4aa07db5f7ea200d09a6c1b49e21402f89ed1190893aab5a9180f152e82f85a45753cf5fc19071c5eec827020103a381fc3081f9301d0603551d0e041604144fe4a0b3dd9cba29f71d7287c4e7c38f2086c2993081c90603551d230481c13081be80144fe4a0b3dd9cba29f71d7287c4e7c38f2086c299a1819aa48197308194310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630140603550407130d4d6f756e7461696e20566965773110300e060355040a1307416e64726f69643110300e060355040b1307416e64726f69643110300e06035504031307416e64726f69643122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d820900b3998086d056cffa300c0603551d13040530030101ff300d06092a864886f70d01010405000382010100572551b8d93a1f73de0f6d469f86dad6701400293c88a0cd7cd778b73dafcc197fab76e6212e56c1c761cfc42fd733de52c50ae08814cefc0a3b5a1a4346054d829f1d82b42b2048bf88b5d14929ef85f60edd12d72d55657e22e3e85d04c831d613d19938bb8982247fa321256ba12d1d6a8f92ea1db1c373317ba0c037f0d1aff645aef224979fba6e7a14bc025c71b98138cef3ddfc059617cf24845cf7b40d6382f7275ed738495ab6e5931b9421765c491b72fb68e080dbdb58c2029d347c8b328ce43ef6a8b15533edfbe989bd6a48dd4b202eda94c6ab8dd5b8399203daae2ed446232e4fe9bd961394c6300e5138e3cfd285e6e4e483538cb8b1b357"
    ) == 0
  ) {
    "platform"
  } else if (
    sign.compareTo(
      "308204a830820390a003020102020900f2b98e6123572c4e300d06092a864886f70d0101040500308194310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630140603550407130d4d6f756e7461696e20566965773110300e060355040a1307416e64726f69643110300e060355040b1307416e64726f69643110300e06035504031307416e64726f69643122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d301e170d3038303431353233343035375a170d3335303930313233343035375a308194310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630140603550407130d4d6f756e7461696e20566965773110300e060355040a1307416e64726f69643110300e060355040b1307416e64726f69643110300e06035504031307416e64726f69643122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d30820120300d06092a864886f70d01010105000382010d00308201080282010100ae250c5a16ef97fc2869ac651b3217cc36ba0e86964168d58a049f40ce85867123a3ffb4f6d949c33cf2da3a05c23eacaa57d803889b1759bcf59e7c6f21890ae25085b7ed56aa626c0989ef9ccd36362ca0e8d1b9603fd4d8328767926ccc090c68b775ae7ff30934cc369ef2855a2667df0c667fd0c7cf5d8eba655806737303bb624726eabaedfb72f07ed7a76ab3cb9a381c4b7dcd809b140d891f00213be401f58d6a06a61eadc3a9c2f1c6567285b09ae09342a66fa421eaf93adf7573a028c331d70601ab3af7cc84033ece7c772a3a5b86b0dbe9d777c3a48aa9801edcee2781589f44d9e4113979600576a99410ba81091259dad98c6c68ff784b8f020103a381fc3081f9301d0603551d0e04160414ca293caa8bc0ed3e542eef4205a2bff2b57e4d753081c90603551d230481c13081be8014ca293caa8bc0ed3e542eef4205a2bff2b57e4d75a1819aa48197308194310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630140603550407130d4d6f756e7461696e20566965773110300e060355040a1307416e64726f69643110300e060355040b1307416e64726f69643110300e06035504031307416e64726f69643122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d820900f2b98e6123572c4e300c0603551d13040530030101ff300d06092a864886f70d0101040500038201010084de9516d5e4a87217a73da8487048f53373a5f733f390d61bdf3cc9e5251625bfcaa7c3159cae275d172a9ae1e876d5458127ac542f68290dd510c0029d8f51e0ee156b7b7b5acdb394241b8ec78b74e5c42c5cafae156caf5bd199a23a27524da072debbe378464a533630b0e4d0ffb7e08ecb701fadb6379c74467f6e00c6ed888595380792038756007872c8e3007af423a57a2cab3a282869b64c4b7bd5fc187d0a7e2415965d5aae4e07a6df751b4a75e9793c918a612b81cd0b628aee0168dc44e47b10d3593260849d6adf6d727dc24444c221d3f9ecc368cad07999f2b8105bc1f20d38d41066cc1411c257a96ea4349f5746565507e4e8020a1a81"
    ) == 0
  ) {
    "2"
  } else if (
    sign.compareTo(
      "3082040b308202f3a00302010202147ddc5ba360c0bf605c37f568555ebf8babf0c80b300d06092a864886f70d01010b0500308194310b30090603550406130255533113301106035504080c0a43616c69666f726e69613116301406035504070c0d4d6f756e7461696e20566965773110300e060355040a0c07416e64726f69643110300e060355040b0c07416e64726f69643110300e06035504030c07416e64726f69643122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d301e170d3232303232343136303534375a170d3439303731323136303534375a308194310b30090603550406130255533113301106035504080c0a43616c69666f726e69613116301406035504070c0d4d6f756e7461696e20566965773110300e060355040a0c07416e64726f69643110300e060355040b0c07416e64726f69643110300e06035504030c07416e64726f69643122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d30820122300d06092a864886f70d01010105000382010f003082010a0282010100d84095aa8204eb35ed6aac555896929f4f2a01a3661c3134382fb1dc031ce3213beb4387e5b2673aad7f2e20e9b73fe7f8ba072fd6922623c619b1d14acfe338f22553371f162faaf44090074780d056d0d5ed77edca012971da20c1cda45cabb687c57a12d79a805a85231b9d356b13d44313ac13bb3c3228ab990ac18435e075d42e2fdb22d628a9af2b9573f0e763f9f5711cc1f8eae956a9448724521f8058db13e347b431daf2b89734bc2ea5fba5400002941862339e061332e679f8053499b48256faed64548187234f28901aa46b88b41cbdaa1c0e688fea8775a4b4a0d72109afca8d4771213272a7b2a9789a7792c157c25cf66e2be512bfcae1150203010001a3533051301d0603551d0e04160414a6815bf6633c815bd540a5f781bb9d908577832c301f0603551d23041830168014a6815bf6633c815bd540a5f781bb9d908577832c300f0603551d130101ff040530030101ff300d06092a864886f70d01010b0500038201010028a541d94bebdaaca9c0c96d2bae76d578191d99d612b251dc7dc27427482af1954a72aa6e3c1e72c4957d1765ed67033dcf58be1780087ac8c66ef57ea199370e853a001fff9db6d815c62b7ffebf1c3d888195349eec2e1d39c152eaff7deaf287f4d75b63b2e79c7b6968e2dd08cd919c1481e1fa66e52ebc7e8cebfe6f27704aedaa89bf39429343ad0f93fc17171a1ea4189b2489fc67f5d4e7c955e6017fc076ef00e9c418f5c866d6ae8fa6a86670083accb59055220f4181b0a59c2dd88cf0c0714a4eb807124a17892b9a9934359e527d3ded56eee366514927f0b87e0770f5aa61c26a22e6df3fd48516ac14683b88b14d4ad6e529317c4e8c0598"
    ) == 0
  ) {
    "3"
  } else if (
    sign.compareTo(
      "308204a830820390a003020102020900936eacbe07f201df300d06092a864886f70d0101050500308194310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630140603550407130d4d6f756e7461696e20566965773110300e060355040a1307416e64726f69643110300e060355040b1307416e64726f69643110300e06035504031307416e64726f69643122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d301e170d3038303232393031333334365a170d3335303731373031333334365a308194310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630140603550407130d4d6f756e7461696e20566965773110300e060355040a1307416e64726f69643110300e060355040b1307416e64726f69643110300e06035504031307416e64726f69643122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d30820120300d06092a864886f70d01010105000382010d00308201080282010100d6931904dec60b24b1edc762e0d9d8253e3ecd6ceb1de2ff068ca8e8bca8cd6bd3786ea70aa76ce60ebb0f993559ffd93e77a943e7e83d4b64b8e4fea2d3e656f1e267a81bbfb230b578c20443be4c7218b846f5211586f038a14e89c2be387f8ebecf8fcac3da1ee330c9ea93d0a7c3dc4af350220d50080732e0809717ee6a053359e6a694ec2cb3f284a0a466c87a94d83b31093a67372e2f6412c06e6d42f15818dffe0381cc0cd444da6cddc3b82458194801b32564134fbfde98c9287748dbf5676a540d8154c8bbca07b9e247553311c46b9af76fdeeccc8e69e7c8a2d08e782620943f99727d3c04fe72991d99df9bae38a0b2177fa31d5b6afee91f020103a381fc3081f9301d0603551d0e04160414485900563d272c46ae118605a47419ac09ca8c113081c90603551d230481c13081be8014485900563d272c46ae118605a47419ac09ca8c11a1819aa48197308194310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630140603550407130d4d6f756e7461696e20566965773110300e060355040a1307416e64726f69643110300e060355040b1307416e64726f69643110300e06035504031307416e64726f69643122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d820900936eacbe07f201df300c0603551d13040530030101ff300d06092a864886f70d010105050003820101007aaf968ceb50c441055118d0daabaf015b8a765a27a715a2c2b44f221415ffdace03095abfa42df70708726c2069e5c36eddae0400be29452c084bc27eb6a17eac9dbe182c204eb15311f455d824b656dbe4dc2240912d7586fe88951d01a8feb5ae5a4260535df83431052422468c36e22c2a5ef994d61dd7306ae4c9f6951ba3c12f1d1914ddc61f1a62da2df827f603fea5603b2c540dbd7c019c36bab29a4271c117df523cdbc5f3817a49e0efa60cbd7f74177e7a4f193d43f4220772666e4c4d83e1bd5a86087cf34f2dec21e245ca6c2bb016e683638050d2c430eea7c26a1c49d3760a58ab7f1a82cc938b4831384324bd0401fa12163a50570e684d"
    ) == 0
  ) {
    "testkey"
  } else if (
    sign.compareTo(
      "308204a830820390a003020102020900936eacbe07f201df300d06092a864886f70d0101050500308194310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630140603550407130d4d6f756e7461696e20566965773110300e060355040a1307416e64726f69643110300e060355040b1307416e64726f69643110300e06035504031307416e64726f69643122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d301e170d3038303232393031333334365a170d3335303731373031333334365a308194310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630140603550407130d4d6f756e7461696e20566965773110300e060355040a1307416e64726f69643110300e060355040b1307416e64726f69643110300e06035504031307416e64726f69643122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d30820120300d06092a864886f70d01010105000382010d00308201080282010100d6931904dec60b24b1edc762e0d9d8253e3ecd6ceb1de2ff068ca8e8bca8cd6bd3786ea70aa76ce60ebb0f993559ffd93e77a943e7e83d4b64b8e4fea2d3e656f1e267a81bbfb230b578c20443be4c7218b846f5211586f038a14e89c2be387f8ebecf8fcac3da1ee330c9ea93d0a7c3dc4af350220d50080732e0809717ee6a053359e6a694ec2cb3f284a0a466c87a94d83b31093a67372e2f6412c06e6d42f15818dffe0381cc0cd444da6cddc3b82458194801b32564134fbfde98c9287748dbf5676a540d8154c8bbca07b9e247553311c46b9af76fdeeccc8e69e7c8a2d08e782620943f99727d3c04fe72991d99df9bae38a0b2177fa31d5b6afee91f020103a381fc3081f9301d0603551d0e04160414485900563d272c46ae118605a47419ac09ca8c113081c90603551d230481c13081be8014485900563d272c46ae118605a47419ac09ca8c11a1819aa48197308194310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630140603550407130d4d6f756e7461696e20566965773110300e060355040a1307416e64726f69643110300e060355040b1307416e64726f69643110300e06035504031307416e64726f69643122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d820900936eacbe07f201df300c0603551d13040530030101ff300d06092a864886f70d010105050003820101007aaf968ceb50c441055118d0daabaf015b8a765a27a715a2c2b44f221415ffdace03095abfa42df70708726c2069e5c36eddae0400be29452c084bc27eb6a17eac9dbe182c204eb15311f455d824b656dbe4dc2240912d7586fe88951d01a8feb5ae5a4260535df83431052422468c36e22c2a5ef994d61dd7306ae4c9f6951ba3c12f1d1914ddc61f1a62da2df827f603fea5603b2c540dbd7c019c36bab29a4271c117df523cdbc5f3817a49e0efa60cbd7f74177e7a4f193d43f4220772666e4c4d83e1bd5a86087cf34f2dec21e245ca6c2bb016e683638050d2c430eea7c26a1c49d3760a58ab7f1a82cc938b4831384324bd0401fa12163a50570e684d"
    ) == 0
  ) {
    "4"
  } else if (
    sign.compareTo(
      "308205dd308203c502146b4971522e2ac489da6932476899cd47dbb0d7e6300d06092a864886f70d01010b05003081a9310b30090603550406130255533113301106035504080c0a43616c69666f726e69613116301406035504070c0d4d6f756e7461696e20566965773110300e060355040a0c07416e64726f69643110300e060355040b0c07416e64726f69643122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d3125302306035504030c1c636f6d2e616e64726f69642e666564657261746564636f6d707574653020170d3233303133303230333931305a180f34373630313232363230333931305a3081a9310b30090603550406130255533113301106035504080c0a43616c69666f726e69613116301406035504070c0d4d6f756e7461696e20566965773110300e060355040a0c07416e64726f69643110300e060355040b0c07416e64726f69643122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d3125302306035504030c1c636f6d2e616e64726f69642e666564657261746564636f6d7075746530820222300d06092a864886f70d01010105000382020f003082020a0282020100c67ada6900928aed27d480f6da2f676958bedb0d563c01eb8ce8b83c8f1141ed67a668902a32cb7bd3facb15310eeb9cec72a1705f32ae667a5921b5863b9487bf32a6fb93858b48ba26a8775b493337c0ee015d784a221b8e8902315004fad89d4b55c1f4c9417b9d20095952c606767cdb7f2fe4a922f7c27eddf8c253235cd59bd80412481d39e5e1532a4192af29cbfe4f70eca7ed03058a4b88fe67a4735bd6f0c8c38f05630a26be05ef95e92e8bd667bf87baa9ce99ea49c026c83b5936c31e121ec1a7f93d8b2ffaacbe7bc0be621aa62c1042f0181a2b9513775c60ed69b60179161a07d85bbc6972a013dcabb043459083d322737400934f07bd572241bcdc44734f0d684978a595737af2b287e3e034b6638431524d51a15bda4ecab1ced5ab45a44e24ce597ee21a43bba2ed13d96fd96ed20d52496e4a4d5e79a0206f86f5be89e0bb7069e13039de094c88dbab3b075d3bbaacf16f36ed1e6cf7ed604d4ae37235fcec5fd7bbbea71af41725925d4efec10bc6d8bf10c69b09552b007dbc89fc15706c70d796099e4306bdb5243c0f329477d3176586204788d686517cc7303fa24d26332df31da5e71ce483c01b4282ec74edf966cdf2b7673a3db5ec58ccc0728f2e9adea60b8f576e718003860f02b079f3f51da7a9ab23344f25a4219741ba2d253b3c99370ebcb43ce5adca78c7ca89925d89e31d9f5d0203010001300d06092a864886f70d01010b05000382020100a3be5552bdcecfd1c504fded2225a75c7216eafe47a6cb508ddc415dd3ba6a3724de6f752a8fbdd6adf300d50e06fbf4678505665f3bb66482bfbd53732eda4a8ae506f019db0e9871b9a940c5619389832b1eb4e3f3f95ea1e9caa10be353c9166ca9f38927bcee7d971b47398d6b695a940d515a26825611eca131c4aaf6413f80a9d2a59598ffc3b79a536665d0c1d032327d3e0cdc2deee25cfa03635909a15b3cc389ff5a7a8cc76ff1db4f00de58dbefccd0e5c974685930e776085bd2ab783f859b19e4242831f04fad97ef9b8ac90eb6bf21182a2d4f98de0d315071cb837854ecc1047c83b441cf4a243bb19bbd0adafb6c02a49795f78efd4f7a3e24ca33fcd12a56ee8b8e4e67557df116ee58bf1a0795cf0c72ba515d769480cd3d796b826388ded16063116d347ade913bd71c85b38d12b56a565ee45ae3c2bbf26a68a06c7d95697cd7d2e01e58616257689b980e790d6a8a3fb8979df2cdf21171e14b351ec38721bb1ec8cd5981edfa45c32e4d76ba7925a2aab86f7a74d494d2acb6f85dea8423b77f18c47f71b53c069f13193953edd906fb772684aebe15c724a72a9a916a01c99c9acabe5f3c0dafcbc36e7d8967c0af57409a2712106c08f7f37dc54dbb727628d5c9c083cda61f61fae3794524aec2cb78f351356f35ccaa05608aba0bf7a0af65062414ccc0003607bce6b632a8652954a0661602"
    ) == 0
  ) {
    "5"
  } else if (
    sign.compareTo(
      "308204a830820390a003020102020900936eacbe07f201df300d06092a864886f70d0101050500308194310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630140603550407130d4d6f756e7461696e20566965773110300e060355040a1307416e64726f69643110300e060355040b1307416e64726f69643110300e06035504031307416e64726f69643122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d301e170d3038303232393031333334365a170d3335303731373031333334365a308194310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630140603550407130d4d6f756e7461696e20566965773110300e060355040a1307416e64726f69643110300e060355040b1307416e64726f69643110300e06035504031307416e64726f69643122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d30820120300d06092a864886f70d01010105000382010d00308201080282010100d6931904dec60b24b1edc762e0d9d8253e3ecd6ceb1de2ff068ca8e8bca8cd6bd3786ea70aa76ce60ebb0f993559ffd93e77a943e7e83d4b64b8e4fea2d3e656f1e267a81bbfb230b578c20443be4c7218b846f5211586f038a14e89c2be387f8ebecf8fcac3da1ee330c9ea93d0a7c3dc4af350220d50080732e0809717ee6a053359e6a694ec2cb3f284a0a466c87a94d83b31093a67372e2f6412c06e6d42f15818dffe0381cc0cd444da6cddc3b82458194801b32564134fbfde98c9287748dbf5676a540d8154c8bbca07b9e247553311c46b9af76fdeeccc8e69e7c8a2d08e782620943f99727d3c04fe72991d99df9bae38a0b2177fa31d5b6afee91f020103a381fc3081f9301d0603551d0e04160414485900563d272c46ae118605a47419ac09ca8c113081c90603551d230481c13081be8014485900563d272c46ae118605a47419ac09ca8c11a1819aa48197308194310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630140603550407130d4d6f756e7461696e20566965773110300e060355040a1307416e64726f69643110300e060355040b1307416e64726f69643110300e06035504031307416e64726f69643122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d820900936eacbe07f201df300c0603551d13040530030101ff300d06092a864886f70d010105050003820101007aaf968ceb50c441055118d0daabaf015b8a765a27a715a2c2b44f221415ffdace03095abfa42df70708726c2069e5c36eddae0400be29452c084bc27eb6a17eac9dbe182c204eb15311f455d824b656dbe4dc2240912d7586fe88951d01a8feb5ae5a4260535df83431052422468c36e22c2a5ef994d61dd7306ae4c9f6951ba3c12f1d1914ddc61f1a62da2df827f603fea5603b2c540dbd7c019c36bab29a4271c117df523cdbc5f3817a49e0efa60cbd7f74177e7a4f193d43f4220772666e4c4d83e1bd5a86087cf34f2dec21e245ca6c2bb016e683638050d2c430eea7c26a1c49d3760a58ab7f1a82cc938b4831384324bd0401fa12163a50570e684d"
    ) == 0
  ) {
    "6"
  } else if (
    sign.compareTo(
      "308205dc308203c4a003020102020900fc6cb0d8a6fdd168300d06092a864886f70d01010b0500308181310b30090603550406130255533113301106035504080c0a43616c69666f726e69613116301406035504070c0d4d6f756e7461696e20566965773110300e060355040a0c07416e64726f69643110300e060355040b0c07416e64726f69643121301f06035504030c18636f6d2e616e64726f69642e6e6574776f726b737461636b3020170d3139303231323031343632305a180f34373537303130383031343632305a308181310b30090603550406130255533113301106035504080c0a43616c69666f726e69613116301406035504070c0d4d6f756e7461696e20566965773110300e060355040a0c07416e64726f69643110300e060355040b0c07416e64726f69643121301f06035504030c18636f6d2e616e64726f69642e6e6574776f726b737461636b30820222300d06092a864886f70d01010105000382020f003082020a0282020100bb71f5137ff0b2d757acc2ca3d378e0f8de11090d5caf3d49e314d35c283b778b02d792d8eba440364ca970985441660f0bc00afbc63dd611b1bf51ad28a1edd21e0048f548b80f8bd113e25682822f57dab8273afaf12c64d19a0c6be238f3e66ddc79b10fd926931e3ee60a7bf618644da3c2c4fc428139d45d27beda7fe45e30075b493ead6ec01cdd55d931c0a657e2e59742ca632b6dc3842a2deb7d22443c809291d7a549203ae6ae356582a4ca23f30f0549c4ec8408a75278e95c69e8390ad5280bcefaef6f1309a41bd9f3bfb5d12dca7e79ec6fd6848193fa9ab728224887b4f93e985ec7cbf6401b0e863a4b91c05d046f040fe954004b1645954fcb4114cee1e8b64b47d719a19ef4c001cb183f7f3e166e43f56d68047c3440da34fdf529d44274b8b2f6afb345091ad8ad4b93bd5c55d52286a5d3c157465db8ddf62e7cdb6b10fb18888046afdd263ae6f2125d9065759c7e42f8610a6746edbdc547d4301612eeec3c3cbd124dececc8d38b20e73b13f24ee7ca13a98c5f61f0c81b07d2b519749bc2bcb9e0949aef6c118a3e8125e6ab57fce46bb091a66740e10b31c740b891900c0ecda9cc69ecb4f3369998b175106dd0a4ffd7024eb7e75fedd1a5b131d0bb2b40c63491e3cf86b8957b21521b3a96ed1376a51a6ac697866b0256dee1bcd9ab9a188bf4ced80b59a5f24c2da9a55eb7b0e502116e30203010001a3533051301d0603551d0e041604149383c92cfbf099d5c47b0c3657d8622a084b72e1301f0603551d230418301680149383c92cfbf099d5c47b0c3657d8622a084b72e1300f0603551d130101ff040530030101ff300d06092a864886f70d01010b050003820201006a0501382fde2a6b8f70c60cd1b8ee4f788718c288b170258ef3a96230b65005650d6a4c42a59a97b2ddec502413e7b438fbd060363d74b74a232382a7f77fd3da34e38f79fad035a8b472c5cff365818a0118d87fa1e31cc7ed4befd27628760c290980c3cc3b7ff0cfd01b75ff1fcc83e981b5b25a54d85b68a80424ac26015fb3a4c754969a71174c0bc283f6c88191dced609e245f5938ffd0ad799198e2d0bf6342221c1b0a5d332ed2fffc668982cabbcb7d3b630ff8476e5c84ac0ad37adf9224035200039f95ec1fa95bf83796c0e8986135cee2dcaef190b249855a7e7397d4a0bf17ea63d978589c6b48118a381fffbd790c44d80233e2e35292a3b5533ca3f2cc173f85cf904adfe2e4e2183dc1eba0ebae07b839a81ff1bc92e292550957c8599af21e9c0497b9234ce345f3f508b1cc872aa55ddb5e773c5c7dd6577b9a8b6daed20ae1ff4b8206fd9f5c8f5a22ba1980bef01ae6fcb2659b97ad5b985fa81c019ffe008ddd9c8130c06fc6032b2149c2209fc438a7e8c3b20ce03650ad31c4ee48f169777a0ae182b72ca31b81540f61f167d8d7adf4f6bb2330ff5c24037245000d8172c12ab5d5aa5890b8b12db0f0e7296264eb66e7f9714c31004649fb4b864005f9c43c80db3f6de52fd44d6e2036bfe7f5807156ed5ab591d06fd6bb93ba4334ea2739af8b41ed2686454e60b666d10738bb7ba88001"
    ) == 0
  ) {
    "7"
  } else if (
    sign.compareTo(
      "308204a830820390a003020102020900936eacbe07f201df300d06092a864886f70d0101050500308194310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630140603550407130d4d6f756e7461696e20566965773110300e060355040a1307416e64726f69643110300e060355040b1307416e64726f69643110300e06035504031307416e64726f69643122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d301e170d3038303232393031333334365a170d3335303731373031333334365a308194310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630140603550407130d4d6f756e7461696e20566965773110300e060355040a1307416e64726f69643110300e060355040b1307416e64726f69643110300e06035504031307416e64726f69643122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d30820120300d06092a864886f70d01010105000382010d00308201080282010100d6931904dec60b24b1edc762e0d9d8253e3ecd6ceb1de2ff068ca8e8bca8cd6bd3786ea70aa76ce60ebb0f993559ffd93e77a943e7e83d4b64b8e4fea2d3e656f1e267a81bbfb230b578c20443be4c7218b846f5211586f038a14e89c2be387f8ebecf8fcac3da1ee330c9ea93d0a7c3dc4af350220d50080732e0809717ee6a053359e6a694ec2cb3f284a0a466c87a94d83b31093a67372e2f6412c06e6d42f15818dffe0381cc0cd444da6cddc3b82458194801b32564134fbfde98c9287748dbf5676a540d8154c8bbca07b9e247553311c46b9af76fdeeccc8e69e7c8a2d08e782620943f99727d3c04fe72991d99df9bae38a0b2177fa31d5b6afee91f020103a381fc3081f9301d0603551d0e04160414485900563d272c46ae118605a47419ac09ca8c113081c90603551d230481c13081be8014485900563d272c46ae118605a47419ac09ca8c11a1819aa48197308194310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630140603550407130d4d6f756e7461696e20566965773110300e060355040a1307416e64726f69643110300e060355040b1307416e64726f69643110300e06035504031307416e64726f69643122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d820900936eacbe07f201df300c0603551d13040530030101ff300d06092a864886f70d010105050003820101007aaf968ceb50c441055118d0daabaf015b8a765a27a715a2c2b44f221415ffdace03095abfa42df70708726c2069e5c36eddae0400be29452c084bc27eb6a17eac9dbe182c204eb15311f455d824b656dbe4dc2240912d7586fe88951d01a8feb5ae5a4260535df83431052422468c36e22c2a5ef994d61dd7306ae4c9f6951ba3c12f1d1914ddc61f1a62da2df827f603fea5603b2c540dbd7c019c36bab29a4271c117df523cdbc5f3817a49e0efa60cbd7f74177e7a4f193d43f4220772666e4c4d83e1bd5a86087cf34f2dec21e245ca6c2bb016e683638050d2c430eea7c26a1c49d3760a58ab7f1a82cc938b4831384324bd0401fa12163a50570e684d"
    ) == 0
  ) {
    "8"
  } else if (
    sign.compareTo(
      "308205d8308203c0a00302010202140bde2adf8f2115a3e6da3a30dd1f386633457371300d06092a864886f70d01010b0500307c310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630140603550407130d4d6f756e7461696e205669657731143012060355040a130b476f6f676c6520496e632e3110300e060355040b1307416e64726f69643118301606035504030c0f636f6d5f616e64726f69645f6e66633020170d3233313130313231333731355a180f32303533313130313231333731355a307c310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630140603550407130d4d6f756e7461696e205669657731143012060355040a130b476f6f676c6520496e632e3110300e060355040b1307416e64726f69643118301606035504030c0f636f6d5f616e64726f69645f6e666330820222300d06092a864886f70d01010105000382020f003082020a0282020100ae98302b22c397c3372916f5171b373f69a7b7cd6c077b8666ce3847a0ba0b01618a20023a611005c9bbf4150a04cac4f5d51bc8e2ff18a96e3730f4dba52c0c4f8ddb00d0f2c893c5a9630c0c21641a6eae13aee2e1fc04a24ece8733025245307a4520c08a417c28b4c8d3f7706e8654a8d36e10e500ddda3ec66a3936d53924c9036504e8b21292a4ad13c1b80af0da49ea86e5fe9cb624279ae800d689543b2228c0c6fe62a78f002776b8156c188a68e75fb9177ea4995e3772d49007d81c706a94e2673c64888df60afbd4e3b0811854439be12308dc26d6c077ce744201833dc83ea32d6a61276d91cd95f5565114cd180176728f831774c3183123ada2b8479a570e4fd6fb8131efbc103c2213f9df7cd7391b4e982c3d7bd99ac073098330ead624b0f8fce9f495254ac986589b0e4e181d516c17b38a6ab35fd38e323e167e594203a9627a181d0653c2d619b6def2268fd2ba3d4350d881873a6ee61621c5fcd5764efa11e05ad51bdab36a214b29ff80e64f5be0cfb4e2316718ee98eb1e5347b557f88c2f8e53673ea7cbb85d4190c5d20a1a0652a0795db40727c2a1ae2296adf654be82d565bc9529f30dd9da0bf8abf6c1559dcd35ab00d5ddc75d54145a2c2ccdc8e256fa1245afc094c5541aeade1916ec88ab321e2b18a7daf19350c174f4bd87bb4cb3fe6b57a44cda765f75f42bef5cd7f62792a33d0203010001a350304e300c0603551d13040530030101ff301d0603551d0e04160414f6ff522f440853d7eaeda07bd3f8ea5412e66495301f0603551d23041830168014f6ff522f440853d7eaeda07bd3f8ea5412e66495300d06092a864886f70d01010b050003820201004c6ddbf345b7ed88842e7efdc822f21cefc19290ca6975310f698eb91f432d091b319338f0ebf8d3ee4f98e1fd239f1b3741b0656cde1bcaee116f5ec1445b05506833a42a172bba4b3e83b17195d8570b6cfd88a82336b39e517a04ed2884cd703fa752a205c44bdcc48c6e0fe2423415c65264cb8043a37f52a0480378bf7e8bb2f8701c194362c104b3c839d13b1bf706d50e9413e28dfe69f3d24937f85220d2ae2ccd70f11fea365786581d23b2f0fe93056f20110ef54463a7874c2d693231d910ffcea2408be07358c2ec0badfa4cd326a8a6acb06e0c1f8e39ba5db0d19cce0a52788249757bb76d2bbfca7ace2470b388fe2e091cb39cc9d12aba6fadf2042d318c863352af995a42de112fda963015f860f21837d4c9636662c3efad642ce2dfc3df0ddf9d21e9d35d4348dc8bfdeba9b6e35629d5428412544cc9700f508108512ca1e23bba119a1b7a8a544b16d19977f3f020c58c36a92c4df54ce5facc20865775f7b0f9e7c7209ed7f99809bb7b4659c6c5605b5e2bf05b98f2e7a776801a0ff0c14d5dab008035fe77a14738673a919bd7a8be556cac589133f0c6b76fede2e8e8ad4e94c30b76fa7d39414edbecf5e173b6d33fa69d51630d33148d20fa3ac079ac4dbda90a0f8ae4bb8d3052735dca08dee056f50bb833fb4b46fe2444a673a61a946d7f9eff9856da6cb0d81bdb770585af3e97060933"
    ) == 0
  ) {
    "9"
  } else if (
    sign.compareTo(
      "308204a830820390a003020102020900936eacbe07f201df300d06092a864886f70d0101050500308194310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630140603550407130d4d6f756e7461696e20566965773110300e060355040a1307416e64726f69643110300e060355040b1307416e64726f69643110300e06035504031307416e64726f69643122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d301e170d3038303232393031333334365a170d3335303731373031333334365a308194310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630140603550407130d4d6f756e7461696e20566965773110300e060355040a1307416e64726f69643110300e060355040b1307416e64726f69643110300e06035504031307416e64726f69643122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d30820120300d06092a864886f70d01010105000382010d00308201080282010100d6931904dec60b24b1edc762e0d9d8253e3ecd6ceb1de2ff068ca8e8bca8cd6bd3786ea70aa76ce60ebb0f993559ffd93e77a943e7e83d4b64b8e4fea2d3e656f1e267a81bbfb230b578c20443be4c7218b846f5211586f038a14e89c2be387f8ebecf8fcac3da1ee330c9ea93d0a7c3dc4af350220d50080732e0809717ee6a053359e6a694ec2cb3f284a0a466c87a94d83b31093a67372e2f6412c06e6d42f15818dffe0381cc0cd444da6cddc3b82458194801b32564134fbfde98c9287748dbf5676a540d8154c8bbca07b9e247553311c46b9af76fdeeccc8e69e7c8a2d08e782620943f99727d3c04fe72991d99df9bae38a0b2177fa31d5b6afee91f020103a381fc3081f9301d0603551d0e04160414485900563d272c46ae118605a47419ac09ca8c113081c90603551d230481c13081be8014485900563d272c46ae118605a47419ac09ca8c11a1819aa48197308194310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630140603550407130d4d6f756e7461696e20566965773110300e060355040a1307416e64726f69643110300e060355040b1307416e64726f69643110300e06035504031307416e64726f69643122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d820900936eacbe07f201df300c0603551d13040530030101ff300d06092a864886f70d010105050003820101007aaf968ceb50c441055118d0daabaf015b8a765a27a715a2c2b44f221415ffdace03095abfa42df70708726c2069e5c36eddae0400be29452c084bc27eb6a17eac9dbe182c204eb15311f455d824b656dbe4dc2240912d7586fe88951d01a8feb5ae5a4260535df83431052422468c36e22c2a5ef994d61dd7306ae4c9f6951ba3c12f1d1914ddc61f1a62da2df827f603fea5603b2c540dbd7c019c36bab29a4271c117df523cdbc5f3817a49e0efa60cbd7f74177e7a4f193d43f4220772666e4c4d83e1bd5a86087cf34f2dec21e245ca6c2bb016e683638050d2c430eea7c26a1c49d3760a58ab7f1a82cc938b4831384324bd0401fa12163a50570e684d"
    ) == 0
  ) {
    "A"
  } else if (
    sign.compareTo(
      "308204a830820390a003020102020900f2a73396bd38767a300d06092a864886f70d0101040500308194310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630140603550407130d4d6f756e7461696e20566965773110300e060355040a1307416e64726f69643110300e060355040b1307416e64726f69643110300e06035504031307416e64726f69643122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d301e170d3038303732333231353735395a170d3335313230393231353735395a308194310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630140603550407130d4d6f756e7461696e20566965773110300e060355040a1307416e64726f69643110300e060355040b1307416e64726f69643110300e06035504031307416e64726f69643122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d30820120300d06092a864886f70d01010105000382010d00308201080282010100c8c2dbfd094a2df45c3ff1a32ed21805ec72fc58d017971bd0f6b52c262d70819d191967e158dfd3a2c7f1b3e0e80ce545d79d2848220211eb86f0fd8312d37b420c113750cc94618ae872f4886463bdc4627caa0c0483c86493e3515571170338bfdcc4cd6addd1c0a2f35f5cf24ed3e4043a3e58e2b05e664ccde12bcb67735fd6df1249c369e62542bc0a4729e53917f5c38ffa52d17b73c9c73798ddb18ed481590875547e66bfc5daca4c25a6eb960ed96923709da302ba646cb496b325e86c5c8b2e7a3377b2bbe4c7cf33254291163f689152ac088550c83c508f4bf5adf0aed5a2dca0583f9ab0ad17650db7eea4b23fdb45885547d0feab72183889020103a381fc3081f9301d0603551d0e04160414cb4c7e2cdbb3f0ada98dab79968d172e9dbb1ed13081c90603551d230481c13081be8014cb4c7e2cdbb3f0ada98dab79968d172e9dbb1ed1a1819aa48197308194310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630140603550407130d4d6f756e7461696e20566965773110300e060355040a1307416e64726f69643110300e060355040b1307416e64726f69643110300e06035504031307416e64726f69643122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d820900f2a73396bd38767a300c0603551d13040530030101ff300d06092a864886f70d0101040500038201010040a8d096997959e917a36c44246b6bac2bae05437ecd89794118f7834720352d1c6f8a39b0869942f4da65981faa2951d33971129ec1921d795671c527d6e249f252829faf5b591310311e2de096500d568ad4114a656dc34a8c6f610453afc1ea7992dba4aa7b3f8543a6e35c0728de77fe97eeac83771fd0ec90f8e4449434ee0b6045783e70c7a2e460249260e003cf7608dc352a4c9ef706def4b26050e978ae2fffd7a3323787014915eb3cc874fcc7a9ae930877c5c8c7d1c2e2a8ee863c89180d1855cedba400e7ba43cccaa7243d397e7c0e8e8e4d7d4f92b6bbead49c0cf018069eddca2e7e2fb4668d89dbbd7950d0cd254180fa1eaafc2a556f84"
    ) == 0
  ) {
    "B"
  } else if (
    sign.compareTo(
      "308204a830820390a003020102020900936eacbe07f201df300d06092a864886f70d0101050500308194310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630140603550407130d4d6f756e7461696e20566965773110300e060355040a1307416e64726f69643110300e060355040b1307416e64726f69643110300e06035504031307416e64726f69643122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d301e170d3038303232393031333334365a170d3335303731373031333334365a308194310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630140603550407130d4d6f756e7461696e20566965773110300e060355040a1307416e64726f69643110300e060355040b1307416e64726f69643110300e06035504031307416e64726f69643122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d30820120300d06092a864886f70d01010105000382010d00308201080282010100d6931904dec60b24b1edc762e0d9d8253e3ecd6ceb1de2ff068ca8e8bca8cd6bd3786ea70aa76ce60ebb0f993559ffd93e77a943e7e83d4b64b8e4fea2d3e656f1e267a81bbfb230b578c20443be4c7218b846f5211586f038a14e89c2be387f8ebecf8fcac3da1ee330c9ea93d0a7c3dc4af350220d50080732e0809717ee6a053359e6a694ec2cb3f284a0a466c87a94d83b31093a67372e2f6412c06e6d42f15818dffe0381cc0cd444da6cddc3b82458194801b32564134fbfde98c9287748dbf5676a540d8154c8bbca07b9e247553311c46b9af76fdeeccc8e69e7c8a2d08e782620943f99727d3c04fe72991d99df9bae38a0b2177fa31d5b6afee91f020103a381fc3081f9301d0603551d0e04160414485900563d272c46ae118605a47419ac09ca8c113081c90603551d230481c13081be8014485900563d272c46ae118605a47419ac09ca8c11a1819aa48197308194310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630140603550407130d4d6f756e7461696e20566965773110300e060355040a1307416e64726f69643110300e060355040b1307416e64726f69643110300e06035504031307416e64726f69643122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d820900936eacbe07f201df300c0603551d13040530030101ff300d06092a864886f70d010105050003820101007aaf968ceb50c441055118d0daabaf015b8a765a27a715a2c2b44f221415ffdace03095abfa42df70708726c2069e5c36eddae0400be29452c084bc27eb6a17eac9dbe182c204eb15311f455d824b656dbe4dc2240912d7586fe88951d01a8feb5ae5a4260535df83431052422468c36e22c2a5ef994d61dd7306ae4c9f6951ba3c12f1d1914ddc61f1a62da2df827f603fea5603b2c540dbd7c019c36bab29a4271c117df523cdbc5f3817a49e0efa60cbd7f74177e7a4f193d43f4220772666e4c4d83e1bd5a86087cf34f2dec21e245ca6c2bb016e683638050d2c430eea7c26a1c49d3760a58ab7f1a82cc938b4831384324bd0401fa12163a50570e684d"
    ) == 0
  ) {
    "C"
  } else if (
    sign.compareTo(
      "3082040b308202f3a0030201020214316246427ac953bcc11293eabfadeed873a589bd300d06092a864886f70d01010b0500308194310b30090603550406130255533113301106035504080c0a43616c69666f726e69613116301406035504070c0d4d6f756e7461696e20566965773110300e060355040a0c07416e64726f69643110300e060355040b0c07416e64726f69643110300e06035504030c07416e64726f69643122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d301e170d3231313130323137303231345a170d3439303332303137303231345a308194310b30090603550406130255533113301106035504080c0a43616c69666f726e69613116301406035504070c0d4d6f756e7461696e20566965773110300e060355040a0c07416e64726f69643110300e060355040b0c07416e64726f69643110300e06035504030c07416e64726f69643122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d30820122300d06092a864886f70d01010105000382010f003082010a0282010100d3d8f77724f1bfca236f8b178eb597b265d36047b3feee97ea9a3cfa6597a75c65d58f718d8af16513881353092fc69acbc89826286ac7b4415933c962d6194cb12503777242e3200c82ad950477400311a1cd882ab91f7086e812cef5c65efc1274d241f4494d4105bcd8a0ce37c17b7255b4d0c2f4147fdf722ff683440fce2a5bd0b9e21e135872f2be8ef9ba7ccf414192eae1088611daffcca765941660477437001036a6dc31d6cdf019fab1144289d10e20f77c52ef03b48a1f2e2eff60ca38087d50e5fe5441bb4fb6a5369bc7e340df5663331acef5a5b5113e1d80c7f589d708b02c56270d7661610255eb8b5e671b60224674ab1eefe96a701ceb0203010001a3533051301d0603551d0e04160414dc5e6bd838496d17e424abaab358633ffd1d0941301f0603551d23041830168014dc5e6bd838496d17e424abaab358633ffd1d0941300f0603551d130101ff040530030101ff300d06092a864886f70d01010b05000382010100c1043cfc3ddffd64b9730a9cb05a53f90ce293dc93bb9de7b17cffa410d26de337cd7d5109e8d7b265e13e337b72ed2e25896b22e02b39a807482e690dc8ba1b3730ba79e79116b3480993a472d246079b70b80a1cb0a987db2e948d6bf36c7dba9178ef32e56df913aed189af27a3fb2589d8d7bc8ab2483de351d33d2c4c1589d8d820e797b31568f79a2873c3867a614f6dc4907b1a3f5e3585dd72e6e3a0db3699253fe9d47e1f026d0fae05b87df140b18c66c722cc237c37a6f9c5aca3c0fb2ccd085a1c8e22478a0627da6b6c3774268ca5c16af62eb42162e5900a7db4706e5886bb59b218fa7f57865754c361df31ce26a98a5ab0ceb721011bcff2"
    ) == 0
  ) {
    "D"
  } else if (
    sign.compareTo(
      "308204a830820390a003020102020900936eacbe07f201df300d06092a864886f70d0101050500308194310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630140603550407130d4d6f756e7461696e20566965773110300e060355040a1307416e64726f69643110300e060355040b1307416e64726f69643110300e06035504031307416e64726f69643122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d301e170d3038303232393031333334365a170d3335303731373031333334365a308194310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630140603550407130d4d6f756e7461696e20566965773110300e060355040a1307416e64726f69643110300e060355040b1307416e64726f69643110300e06035504031307416e64726f69643122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d30820120300d06092a864886f70d01010105000382010d00308201080282010100d6931904dec60b24b1edc762e0d9d8253e3ecd6ceb1de2ff068ca8e8bca8cd6bd3786ea70aa76ce60ebb0f993559ffd93e77a943e7e83d4b64b8e4fea2d3e656f1e267a81bbfb230b578c20443be4c7218b846f5211586f038a14e89c2be387f8ebecf8fcac3da1ee330c9ea93d0a7c3dc4af350220d50080732e0809717ee6a053359e6a694ec2cb3f284a0a466c87a94d83b31093a67372e2f6412c06e6d42f15818dffe0381cc0cd444da6cddc3b82458194801b32564134fbfde98c9287748dbf5676a540d8154c8bbca07b9e247553311c46b9af76fdeeccc8e69e7c8a2d08e782620943f99727d3c04fe72991d99df9bae38a0b2177fa31d5b6afee91f020103a381fc3081f9301d0603551d0e04160414485900563d272c46ae118605a47419ac09ca8c113081c90603551d230481c13081be8014485900563d272c46ae118605a47419ac09ca8c11a1819aa48197308194310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630140603550407130d4d6f756e7461696e20566965773110300e060355040a1307416e64726f69643110300e060355040b1307416e64726f69643110300e06035504031307416e64726f69643122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d820900936eacbe07f201df300c0603551d13040530030101ff300d06092a864886f70d010105050003820101007aaf968ceb50c441055118d0daabaf015b8a765a27a715a2c2b44f221415ffdace03095abfa42df70708726c2069e5c36eddae0400be29452c084bc27eb6a17eac9dbe182c204eb15311f455d824b656dbe4dc2240912d7586fe88951d01a8feb5ae5a4260535df83431052422468c36e22c2a5ef994d61dd7306ae4c9f6951ba3c12f1d1914ddc61f1a62da2df827f603fea5603b2c540dbd7c019c36bab29a4271c117df523cdbc5f3817a49e0efa60cbd7f74177e7a4f193d43f4220772666e4c4d83e1bd5a86087cf34f2dec21e245ca6c2bb016e683638050d2c430eea7c26a1c49d3760a58ab7f1a82cc938b4831384324bd0401fa12163a50570e684d"
    ) == 0
  ) {
    "E"
  } else if (
    sign.compareTo(
      "3082063b30820423a003020102021412265aa5a599552b5eaf4e8224c7f69078bc3c8b300d06092a864886f70d01010b05003081ab310b30090603550406130255533113301106035504080c0a43616c69666f726e69613116301406035504070c0d4d6f756e7461696e20566965773110300e060355040a0c07416e64726f69643110300e060355040b0c07416e64726f69643127302506035504030c1e636f6d2e616e64726f69642e626c7565746f6f74682e73657276696365733122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d3020170d3232303331353030333630335a180f34373630303230393030333630335a3081ab310b30090603550406130255533113301106035504080c0a43616c69666f726e69613116301406035504070c0d4d6f756e7461696e20566965773110300e060355040a0c07416e64726f69643110300e060355040b0c07416e64726f69643127302506035504030c1e636f6d2e616e64726f69642e626c7565746f6f74682e73657276696365733122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d30820222300d06092a864886f70d01010105000382020f003082020a0282020100b1596af69a3351110695bf2ef18d007d8c0fb393ae6af371fc4b17d376938e601751f48e3007b0ab35170c8463c3c510bce5badeeb5a674828f68b033f335f5447ed986c56fc0502f8758668b0d07c260eddf89c3cf392ef1a4484664444d6e786f879a97d0d06dea627282c7e93a644f4e16e2e8883606bc61d5ea9562a4644e384d14a0fa8027753dd32651217cf311186995af4e4113f3d661dfc94bcdadb1ff07cd666092015bab370d4a7fd3507d8b1a187c0cb23aef4f2846f774d3617cd1045cc03b65a5062c3a474b50afc656e5708cf58a3a012d0a5e2534656c0e5f184676bdfcacd77b8fd9d9b691705a637592079bfefa447ead1896e6bd072b944677c966ed8ae136c56a6bb28e2848b6b6b664a3ad14d3c37ae82028c0a4b99cfa594f050a8304a67ab93f66a0c4d38601aef29d774dcde93df0ddd3197f2ab5f1200afeafcae33481a909e83f67338de7b029b52e407f240d0269c5b247396368b2f50b84b8ddacc4398c8e39bf782139e4642406b47df7931cda9b23cb219dfb545e3ebfac935f248b0733a785e3ace6e0480e885526e23cdfc6cb8597fc7b9988ae78e22b0b261315e242f82275bc2f64a0b3f67f184f88948563f1e055be18f722bd9b2fb0409c9c9d905112b5ce18abe50b8b4bb65b02d878922114c49eae8c5e637ed13e2ff0a52b62e2634d885d644272df09d617c9659c7c966dcf50203010001a3533051301d0603551d0e04160414ee4282d43329b4c477f43daf12b5e1af41070159301f0603551d23041830168014ee4282d43329b4c477f43daf12b5e1af41070159300f0603551d130101ff040530030101ff300d06092a864886f70d01010b050003820201006ac64b5ce66a801156aeea86863ec7349cd48fd3cdfeaf1ba687042f82708a12336a2aafa4c61fe0031c063a8e1bbfab3bf58a3de0b6822702406d916bd8b0221578848f8fc42899c77c108796efba7e02b2b34b81d8e66d5cfcee03ff9ae497a7347b116ae0f770f55f31c8cf7c42d2dda23e31cf35d44cf388c2444e1e48fca2d70c2f6f26fcc0b497fe1bf9f9479cfa8a16e2c18e1c62f5bfd97f06977e39314dc5e93379cf1fcccdee4689a52d5f3d6d48272c4962f4f4db6b8af9a7e97b34e6c92ff9d1a3a77141a30c9470f0270e07cf0ef25a62cc30f7b43ecfea354ea514494b84a791512b6c89f5c5d58447ab9b8679f2707ed4983548c7ebcd77fb7a6036b7efb6aef196be2e76c33df575f8e83e45a2521088c981f632aa78c1c4675118ddb555ba89751ce8fde3b864577698656d328b15af48f0e0ef2beb4a3da0c3160536c5a71388f76f5075c57e5f52f3f00f01673d1f6977d9d99f6eb1cb6e5b616d6607b7b6c274ef3ee4ba135d6e79b6c9055f77416a889b1aa548e586071d155a0358fbaa39f580a06df56e57ba7a2367c5f8e209c90f5b2722204ea5c3dee7bdabc68e551a707e6a546f3a84e594ef1c8181e4343c7e1ef8dc6be74c9403418cc678b581e7d9146f2a10f74d46e0d3d5076a0c687ff046b5d46114317740c64d14ceac80b4b0ebe8c6f02ba9559aa99eb9e15da20763bd0de65def78"
    ) == 0
  ) {
    "F"
  } else if (
    sign.compareTo(
      "308204a830820390a003020102020900936eacbe07f201df300d06092a864886f70d0101050500308194310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630140603550407130d4d6f756e7461696e20566965773110300e060355040a1307416e64726f69643110300e060355040b1307416e64726f69643110300e06035504031307416e64726f69643122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d301e170d3038303232393031333334365a170d3335303731373031333334365a308194310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630140603550407130d4d6f756e7461696e20566965773110300e060355040a1307416e64726f69643110300e060355040b1307416e64726f69643110300e06035504031307416e64726f69643122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d30820120300d06092a864886f70d01010105000382010d00308201080282010100d6931904dec60b24b1edc762e0d9d8253e3ecd6ceb1de2ff068ca8e8bca8cd6bd3786ea70aa76ce60ebb0f993559ffd93e77a943e7e83d4b64b8e4fea2d3e656f1e267a81bbfb230b578c20443be4c7218b846f5211586f038a14e89c2be387f8ebecf8fcac3da1ee330c9ea93d0a7c3dc4af350220d50080732e0809717ee6a053359e6a694ec2cb3f284a0a466c87a94d83b31093a67372e2f6412c06e6d42f15818dffe0381cc0cd444da6cddc3b82458194801b32564134fbfde98c9287748dbf5676a540d8154c8bbca07b9e247553311c46b9af76fdeeccc8e69e7c8a2d08e782620943f99727d3c04fe72991d99df9bae38a0b2177fa31d5b6afee91f020103a381fc3081f9301d0603551d0e04160414485900563d272c46ae118605a47419ac09ca8c113081c90603551d230481c13081be8014485900563d272c46ae118605a47419ac09ca8c11a1819aa48197308194310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630140603550407130d4d6f756e7461696e20566965773110300e060355040a1307416e64726f69643110300e060355040b1307416e64726f69643110300e06035504031307416e64726f69643122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d820900936eacbe07f201df300c0603551d13040530030101ff300d06092a864886f70d010105050003820101007aaf968ceb50c441055118d0daabaf015b8a765a27a715a2c2b44f221415ffdace03095abfa42df70708726c2069e5c36eddae0400be29452c084bc27eb6a17eac9dbe182c204eb15311f455d824b656dbe4dc2240912d7586fe88951d01a8feb5ae5a4260535df83431052422468c36e22c2a5ef994d61dd7306ae4c9f6951ba3c12f1d1914ddc61f1a62da2df827f603fea5603b2c540dbd7c019c36bab29a4271c117df523cdbc5f3817a49e0efa60cbd7f74177e7a4f193d43f4220772666e4c4d83e1bd5a86087cf34f2dec21e245ca6c2bb016e683638050d2c430eea7c26a1c49d3760a58ab7f1a82cc938b4831384324bd0401fa12163a50570e684d"
    ) == 0
  ) {
    "G"
  } else {
    "X"
  }
}
